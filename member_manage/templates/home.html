{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Member Registration</title>
    <link rel="stylesheet" href="{% static 'css/home.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700&display=swap" rel="stylesheet">
</head>
<body>
<button id="sidebarToggle" class="sidebar-toggle">
    <i class="fas fa-bars"></i>
</button>
<div class="sidebar">
    <div class="logo">
        <img src="{% static 'images/a.jpg' %}" alt="CRM Logo"/>
        <div style="display: flex; flex-direction: column;">
            <span>Vihangam Yog</span>
            <span>Pune</span>
        </div>
    </div>
    <ul class="menu">
        <li>
            <a href="{% url 'dashboard' %}"><i class="fas fa-tachometer-alt"></i>Dashboard</a>
        </li>
        <li tabindex="0">
            <a href="#"><i class="fas fa-users"></i>Members <i class="fas fa-chevron-down"></i></a>
            <ul class="submenu">
                <li><a href="{% url 'all_members' %}"><i class="fas fa-list"></i>All Members</a></li>
                <li><a href="{% url 'member' %}"><i class="fas fa-user-plus"></i>Add Member</a></li>
            </ul>
        </li>
        <li tabindex="0">
            <a href="#"><i class="fas fa-chalkboard-teacher"></i>Instructor <i class="fas fa-chevron-down"></i></a>
            <ul class="submenu">
                <li><a href="{% url 'add_instructor' %}"><i class="fas fa-user-plus"></i>Add Instructor</a></li>
                <li><a href="{% url 'all_instructors' %}"><i class="fas fa-list"></i>View All Instructors</a></li>
                <li><a href="{% url 'instructor_infographics' %}"><i class="fas fa-chart-pie"></i>Instructor
                    Infographics</a></li>
            </ul>
        </li>
        <li tabindex="0" class="has-submenu">
            <a href="#"><i class="fas fa-chart-bar"></i>Events <i class="fas fa-chevron-down"></i></a>
            <ul class="submenu">
                <li><a href="{% url 'add_event' %}"><i class="fas fa-plus"></i>Add Event</a></li>
                <li><a href="{% url 'record_attendance' %}"><i class="fas fa-clipboard-list"></i>Record Attendance</a>
                </li>
            </ul>
        </li>
        <li tabindex="0">
            <a href="#"><i class="fas fa-cog"></i>Settings <i class="fas fa-chevron-down"></i></a>
            <ul class="submenu">
                <li><a href="{% url 'change_password' %}"><i class="fas fa-key"></i>Change Password</a></li>
                <li><a href="{% url 'upload_members' %}"><i class="fas fa-upload"></i>Upload</a></li>
                <li><a href="{% url 'create_user' %}"><i class="fas fa-user-plus"></i>Create User</a></li>
                <li><a href="#"><i class="fas fa-user"></i>Profile</a></li>
            </ul>
        </li>
        <li>
            <a href="{% url 'logout' %}"><i class="fas fa-sign-out-alt"></i>Logout</a>
        </li>
    </ul>
</div>
<div class="main-content">
    {% block main_content %}
    <section class="registration-section">
        <h2>Register New Member</h2>
        {% if message %}
        <div class="form-alert {% if message_type == 'error' %}error{% endif %}">{{ message }}</div>
        {% endif %}
        <form id="registrationForm" method="post" action="{% url 'register_member' %}">
            {% csrf_token %}
            <div class="form-row">
                <div class="form-group">
                    <label for="name">Full Name</label>
                    <input type="text" name="name" id="name" required value="{{ form_data.name|default:'' }}"/>
                </div>
                <div class="form-group">
                    <label for="number">Contact Number</label>
                    <input type="text" name="number" id="number" required value="{{ form_data.number|default:'' }}"/>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="date_of_initiation">Initiation Date</label>
                    <input type="date" name="date_of_initiation" id="date_of_initiation" required value="{{ form_data.date_of_initiation|default:'' }} "/>
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="text" name="email" id="email" required value="{{ form_data.email|default:'' }}"/>
                </div>
            </div>
            <style>
                #age, #gender, #event {
                    width: 220px;
                    box-sizing: border-box;
                    display: block;
                }
            </style>
            <div class="form-row">
                <div class="form-group">
                    <label for="age">Age</label>
                    <input type="text" name="age" id="age" required value="{{ form_data.age|default:'' }}"/>
                </div>
                <div class="form-group">
                    <label for="gender">Gender</label>
                    <select name="gender" id="gender" required>
                        <option value="">Select Gender</option>
                        <option value="Male" {% if form_data.gender == "Male" %}selected{% endif %}>Male</option>
                        <option value="Female" {% if form_data.gender == "Female" %}selected{% endif %}>Female</option>
                        <option value="Others" {% if form_data.gender == "Others" %}selected{% endif %}>Others</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="event">Event</label>
                    <select name="event" id="event" required>
                        <option value="">Select Event</option>
                        {% for event in events %}
                        <option value="{{ event.id }}" {% if form_data.event_id == event.id %}selected{% endif %}>
                            {{ event.event_name }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="company">Company\Org\Instituion</label>
                    <input type="text" name="company" id="company" value="{{ form_data.company|default:'' }}"/>
                </div>
                <div class="form-group">
                    <label for="instructor">Instructor</label>
                    <select name="instructor" id="instructor" required>
                        <option value="">Select Instructor</option>
                        {% for instructor in instructors %}
                        <option value="{{ instructor.id }}"
                            {% if form_data.instructor|stringformat:"s" == instructor.id|stringformat:"s" %}selected{% endif %}>
                            {{ instructor.name }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="address">Address: Apartment/Street</label>
                    <input type="text" name="address" id="address" value="{{ form_data.address|default:'' }}"/>
                </div>
               <div class="form-group">
                    <label for="member_country">Country</label>
                    <select name="member_country" id="member_country" required>
                        <option value="">Select Country</option>
                        {% for country in countries %}
                        <option value="{{ country.id }}"
                            {% if form_data.member_country|stringformat:"s" == country.id|stringformat:"s" %}selected{% endif %}>
                            {{ country.name }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="member_state">State</label>
                    <select name="member_state" id="member_state" required>
                        <option value="">Select State</option>
                        {% for state in states %}
                        <option value="{{ state.id }}"
                            {% if form_data.member_state|stringformat:"s" == state.id|stringformat:"s" %}selected{% endif %}>
                            {{ state.name }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label for="member_city">City</label>
                    <select name="member_city" id="member_city" required>
                        <option value="">Select City</option>
                        {% for city in cities %}
                        <option value="{{ city.id }}"
                            {% if form_data.member_city|stringformat:"s" == city.id|stringformat:"s" %}selected{% endif %}>
                            {{ city.name }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group full-width">
                    <label for="feedback">Feedback</label>
                    <textarea name="feedback" id="feedback" rows="2">{{ form_data.feedback|default:'' }}</textarea>
                </div>
            </div>
            <div class="form-actions">
                <button type="submit">Register</button>
                <button type="reset" class="reset-btn">Reset</button>
            </div>
        </form>
    </section>
    {% endblock %}
    <footer>
        &copy; {{ year|default:"2025" }} VY Member. All rights reserved.
    </footer>
</div>
<script src="{% static 'js/home.js' %}"></script>
<script>
document.querySelector('.reset-btn').addEventListener('click', function(e) {
    // Prevent default reset
    e.preventDefault();
    // Reset all input, select, and textarea fields
    const form = document.getElementById('registrationForm');
    form.reset();
    // Clear all input values (including those set by Django context)
    form.querySelectorAll('input, textarea').forEach(el => el.value = '');
    form.querySelectorAll('select').forEach(el => el.selectedIndex = 0);
});
</script>
</body>
</html>